---
title: 代码部署
description: 编写代码部署项目
navigation:
  icon: i-lucide-cloud-upload
---


## 代码部署

### Cloud Agent Engine

如果你已经有一个较为成熟的Agent项目，你可以通过VeADK中提供的云引擎来部署你的项目。

```python
from veadk.cloud.cloud_agent_engine import CloudAgentEngine

engine = CloudAgentEngine()

# Create application thru local folder and unique application name
cloud_app = engine.deploy(...)
```

类`CloudAgentEngine`初始化需要传入你的火山引擎AK/SK；如果你没有传入，那么VeADK将自动从你的环境变量中获取。

进行`deploy`函数调用时，关键参数如下：

| 参数名称 | 类型 | 说明 |
| --- | --- | --- |
| path | str | 本地Agent项目路径 |
| application_name | str | 函数服务应用名称 |
| gateway_name | str | 火山引擎 API 网关实例名称 |
| gateway_service_name | str | 火山引擎 API 网关服务名称 |
| gateway_upstream_name | str | 火山引擎 API 网关Upstream名称 |
| use_adk_web | bool | 是否在云端使用VeADK Web / Google Web |
| auth_method | str | 认证方式 |
| identity_user_pool_name | str | 火山引擎 Identity 用户池名称 |
| identity_client_name | str | 火山引擎 Identity 客户端名称 |

### Cloud App

当你使用`CloudAgentEngine`部署完成后，将返回一个`CloudApp`实例，代表云应用，主要功能包括：

- 发起一个远程会话创建请求
- 发起一个Agent执行任务/对话任务

```python
from veadk.cloud.cloud_app import CloudApp

# 创建远程会话
cloud_app.create_session(user_id=..., session_id=...)

# 发起任务
cloud_app.invoke(user_id=..., session_id=..., message=...)
```

- 通过端点发起一个远程会话创建请求

```python
from veadk.cloud.cloud_app import CloudApp

# 创建远程A2A会话
APP_NAME = “veadk-agent”
SESSION_ID = "cloud_app_test_session"
USER_ID = "cloud_app_test_user"
ENDPOINT = "<URL of application deployed by>"

app = CloudApp(name="veadk-agent", endpoint=ENDPOINT)

# 发起任务
cloud_app.invoke(user_id=USER_ID, session_id=SESSION_ID, message=...)
```

### 更新云应用

#### 通过 CloudAgentEngine 更新

当您需要更新已部署的Agent代码时，可以使用`update_function_code`方法：

```python
from veadk.cloud.cloud_agent_engine import CloudAgentEngine

engine = CloudAgentEngine()

# 更新现有应用的代码，保持相同的访问端点
updated_cloud_app = engine.update_function_code(
    application_name="my-agent-app",  # 现有应用名称
    path="/my-agent-project"        # 本地项目路径
)

# 可以使用updated_cloud_app.vefaas_endpoint访问您的项目
```

**注意事项：**

- 更新操作会保持相同的访问端点URL
- 确保项目路径包含`agent.py`文件

### 删除云应用

#### 通过 CloudAgentEngine 删除

```python
from veadk.cloud.cloud_agent_engine import CloudAgentEngine

engine = CloudAgentEngine()

# 删除指定的云应用
engine.remove(app_name="my-agent-app")
```

执行时会提示确认：

```bash
Confirm delete cloud app my-agent-app? (y/N): y
```

输入`y`确认删除，输入其他任何字符或直接回车则取消删除。
